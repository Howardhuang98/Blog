# 《运筹学教程》

## 运筹学的主要分支

1. 线性规划
2. 非线性规划
3. 整数规划
4. 目标规划
5. 动态规划
6. 图论与网络分析

以及储存论，排队论，对策论，决策论。

## 线性规划

一般来讲，主要问题涉及到资源的限制（每天可用的能力），单位项目带来的收益。

![image-20220321193000877](%E3%80%8A%E8%BF%90%E7%AD%B9%E5%AD%A6%E6%95%99%E7%A8%8B%E3%80%8B.assets/image-20220321193000877.png)

![image-20220321193124864](%E3%80%8A%E8%BF%90%E7%AD%B9%E5%AD%A6%E6%95%99%E7%A8%8B%E3%80%8B.assets/image-20220321193124864.png)

线性规划主要由：

* 变量，决策变量
* 目标函数
* 约束条件：变量取值的时候要受到各种限制

### 线性规划问题的标准型

极大值，约束条件为等式，$b_i$为非负值，$x_i$为非负的，写为以下标准形式：

![image-20220321193310994](%E3%80%8A%E8%BF%90%E7%AD%B9%E5%AD%A6%E6%95%99%E7%A8%8B%E3%80%8B.assets/image-20220321193310994.png)

### 求解线性规划

#### 图解法

![image-20220321193559726](%E3%80%8A%E8%BF%90%E7%AD%B9%E5%AD%A6%E6%95%99%E7%A8%8B%E3%80%8B.assets/image-20220321193559726.png)

![image-20220321193609157](%E3%80%8A%E8%BF%90%E7%AD%B9%E5%AD%A6%E6%95%99%E7%A8%8B%E3%80%8B.assets/image-20220321193609157.png)

#### 线性规划可能的几种解

1. 无穷多最优解：最优的取值落在一根线上。
2. 无界解：解的值没有被限制住，可能趋于无穷大
3. 无可行解：没有可行域

### 单纯形法原理

对于一个标准形式的线性规划：

![image-20220321194047766](%E3%80%8A%E8%BF%90%E7%AD%B9%E5%AD%A6%E6%95%99%E7%A8%8B%E3%80%8B.assets/image-20220321194047766.png)

做以下定义：

满足约束条件的解$X$是**可行解**

使目标函数达到最大的，是**最优解**

对于约束条件，一般将其写为约束矩阵$A$，一般来讲它的**秩为m**，或者小于m。在此我们假设为m。

$B$是矩阵$A$中的一个满秩的矩阵，它是一个**基**
$$
\boldsymbol{B}=\left(\begin{array}{ccc}
a_{11} & \cdots & a_{1 m} \\
\vdots & & \vdots \\
a_{m 1} & \cdots & a_{m m}
\end{array}\right)=\left(\boldsymbol{P}_{1}, \cdots, \boldsymbol{P}_{m}\right)
$$
**基解**：使所有的非基变量为0，$BX=b$ 这个方程由于满秩，可以解出唯一解，称之为基解。基解不多于$C_n^{m}$个。

**基可行解**：基解中，满足非负条件的解，称为基可行解。

#### 重要定理

1. 如果线性规划问题存在可行解，那么问题的可行域是凸集；
2. 线性问题的基可行解对应可行域的顶点；
3. 如果线性规划问题由最优解，那么一定存在一个基可行解是最优解。

通过初等行变换，由于秩是m，肯定可以得到这样的情况：
$$
\left(\boldsymbol{P}_{1}, \boldsymbol{P}_{2}, \cdots, \boldsymbol{P}_{m}\right)=\left(\begin{array}{cccc}
1 & 0 & \cdots & 0 \\
0 & 1 & \cdots & 0 \\
\vdots & \vdots & & \vdots \\
0 & 0 & \cdots & 1
\end{array}\right)
$$
对这个求解，可以得到：
$$
\mathbf{X}=\left(x_{1}, \cdots, x_{m}, x_{m+1}, \cdots, x_{n}\right)^{\mathrm{T}}=\left(b_{1}, \cdots, b_{m}, 0, \cdots, 0\right)^{\mathrm{T}}
$$
这样就得到了第一基解，如何通过它来计算下一个顶点呢？

首先：
$$
\sum_{i-1}^{m} \boldsymbol{P}_{i} x_{i}^{0}=\boldsymbol{b}
$$
因为$\left(\boldsymbol{P}_{1}, \boldsymbol{P}_{2}, \cdots, \boldsymbol{P}_{m}\right)$ 是线性无关的，可以用这些向量的线性组合来得到其他向量$\boldsymbol{P}_{j}$：
$$
\boldsymbol{P}_{j}=\sum_{i=1}^{m} a_{i j} \boldsymbol{P}_{i}
$$
所以，加上数学技巧，乘上一个$\theta>0$：
$$
\theta\left(\boldsymbol{P}_{j}-\sum_{i=1}^{m} a_{i j} \boldsymbol{P}_{i}\right)=0
$$
目的是为了找到$x_i^0$ 与 $P_j$的关系，所以把上面的式子，和上上的式子加和，得到：
$$
\sum_{i=1}^{m}\left(x_{i}^{0}-\theta a_{i j}\right) \boldsymbol{P}_{i}+\theta \mathbf{P}_{j}=\boldsymbol{b}
$$
这样的关系式可以用于我们找下一个基解：

对于前面的$P_i$,需要有一个不再作为基向量，所以
$$
x_{i}^{0}-\theta a_{i j} \geqslant 0
$$
有一个$i$是导致这个式子取等号的，所以
$$
\theta=\min _{i}\left\{\frac{x_{i}^{0}}{a_{i j}}\left|a_{i j}\right\rangle 0\right\}=\frac{x_{l}^{0}}{a_{l j}}
$$

#### 最优性检验

第一次基解：
$$
z^{(0)}=\sum_{i=1}^{m} c_{i} x_{i}^{0}
$$
第二次基解：
$$
\begin{aligned}
z^{(1)} &=\sum_{i=1}^{m} c_{i}\left(x_{i}^{0}-\theta a_{i j}\right)+\theta c_{j} \\
&=\sum_{i=1}^{m} c_{i} x_{i}^{0}+\theta\left(c_{j}-\sum_{i=1}^{m} c_{i} a_{i j}\right) \\
&=z^{(0)}+\theta\left(c_{j}-\sum_{i=1}^{m} c_{i} a_{i j}\right)
\end{aligned}
$$
是存在递推关系的，如果
$$
c_j-\sum_{i=1}^{m} c_{i} a_{i j}
$$
这一项小于零，则说明移入该基向量会使目标函数减小。大于零则说明会增大。

判断：

1. 所有$\sigma_{j}<=0$ , 该基解是最优解；
2. 所有$\sigma_{j}<=0$，并且还有等于零的，说明有无穷多解；
3. 所有$\sigma_{j}<=0$，都是严格小于，说明是唯一最优解；
4. 如果存在$\sigma_{j}>0$,且$P_j<=0$, 则说明有**无界解**。

单纯形法案例：

![image-20220321203206915](%E3%80%8A%E8%BF%90%E7%AD%B9%E5%AD%A6%E6%95%99%E7%A8%8B%E3%80%8B.assets/image-20220321203206915.png)

![image-20220321203217563](%E3%80%8A%E8%BF%90%E7%AD%B9%E5%AD%A6%E6%95%99%E7%A8%8B%E3%80%8B.assets/image-20220321203217563.png)

![image-20220321203226399](%E3%80%8A%E8%BF%90%E7%AD%B9%E5%AD%A6%E6%95%99%E7%A8%8B%E3%80%8B.assets/image-20220321203226399.png)